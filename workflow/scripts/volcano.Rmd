### Volcano plot

```{r fig.height=5, fig.width=8}
p <- diffexp_data %>%
  mutate(significant = case_when(
    !!as.symbol(padj_column_name) <= gene_padj_threshold &
      !!as.symbol(fc_column_name) > gene_fc_threshold ~ "up",
    !!as.symbol(padj_column_name) <= gene_padj_threshold &
      !!as.symbol(fc_column_name) <= (-1) * gene_fc_threshold ~ "down",
    TRUE ~ "unchanged"
  )) %>%
  ggplot(
    aes(
      x = !!as.symbol(fc_column_name),
      y = -log10(!!as.symbol(pval_column_name)),
      color = significant,
      text = SYMBOL
    )
  ) +
  geom_point() +
  scale_color_manual(values = c(
    "unchanged" = "gray60",
    "up" = "steelblue",
    "down" = "darkred"
  )) +
  theme_bw() +
  theme(legend.position = "bottom")

p %>%
  ggplotly(tooltip = "text") %>%
  toWebGL()
```
